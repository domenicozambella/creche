% !TEX root = creche.tex
\chapter{Countable models}
\label{countable}

\def\ceq#1#2#3{\parbox[b]{30ex}{$\displaystyle #1$}\parbox[b]{6ex}{\hfil$#2$}$\displaystyle #3$}

In this chapter $L$ is a fix signature, $T$ a complete theory without finite models, and $\U$ is a saturated model of inaccessible cardinality $\kappa$ larger than $|L|$.
We make no blanket assumption on the cardinality of $L$, but the main theorems require $L$ to be countable.
The notation and implicit assumptions are as in Section~\ref{monster}.


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%

\section{The omitting types theorem}\label{omttingtype}

We say that the formula $\phi({\mr x})$ \emph{isolates\/} the type $p({\mr x})$ when $\phi({\mr x})$ is consistent and $\phi({\mr x})\imp p({\mr x})$.
When $\Delta$ is a set of formulas, we say that \emph{$\Delta$ isolates $p({\mr x})$\/} if some formula in $\Delta$ does.
When $\Delta=L_{{\mr x}}(A)$, we say that \emph{$A$ isolates $p({\mr x})$\/} or, when $A$ is clear, that \emph{$p({\mr x})$ is isolated.}
We say that a model \emph{$M$ omits $p({\mr x})$\/} if $p({\mr x})$ is not realized in $M$.

Observe that if $p({\mr x})\subseteq L(M)$ then $M$ realizes $p({\mr x})$ if and only if $M$ isolates  $p({\mr x})$.
Therefore if $A$ isolates $p({\mr x})$, then every model containing $A$ realizes $p({\mr x})$.
Below we prove that the converse holds when $L$ and $A$ are countable.
This is a famous classical theorem that is called the \textit{omitting types theorem\/} because it is proved by constructing a model $M$ that omits a given non-isolated type $p({\mr x})$.

%In our proof $M$ is constructed in stages.
%Along the construction {\em isolated\/}  since that of being {\em realized\/} is not well-behaved in sets which are not models.
%In the limit, when a model is obtained, these two properties coincide.

%The omitting types theorem requires the following lemma which is an analogue of the Kura\-towski-Ulam theorem (i.e., the so-called Fubini theorem for Baire category).

The core of the argument lies in the following lemma. 

\begin{lemma}\label{lem_kuratowskiUlam}
Assume $L(A)$ is countable.
Let $p({\mr x})\subseteq L(A)$ and suppose that $A$ does not isolate $p({\mr x})$.
Then, if $\psi({\gr z})\in L(A)$ is consistent, $\psi({\gr z})$ has a solution ${\gr a}$ such that $A,{\gr a}$ does not isolate $p({\mr x})$.
\end{lemma}
\begin{proof}
We construct a sequence of formulas $\<\psi_i({\gr z}):i<\omega\>$ such that any realization~${\gr a}$ of the type $\big\{\psi_i({\gr z}):i<\omega\big\}$ is the required solution of $\psi({\gr z})$.

Let $\<\xi_i({\mr x}\,;{\gr z}):i<\omega\>$ be an enumeration of $L_{{\mr x}\,;{\gr z}}(A)$.
Set $\psi_0({\gr z})= \psi({\gr z})$ and define $\psi_{i+1}({\gr z})$ inductively as follows:
\begin{itemize}
   \item[1.] if $\xi_i({\mr x}\,;{\gr z})\wedge\psi_i({\gr z})$ is inconsistent, let $\psi_{i+1}({\gr z})=\psi_i({\gr z})$
   \item[2.] otherwise, let $\displaystyle\psi_{i+1}({\gr z})=\psi_i({\gr z}) \wedge \E{\mr x}\,\big[\xi_i({\mr x}\,;{\gr z})\wedge\neg\phi({\mr x})\big]$ for some/any $\phi({\mr x})\in p$ that makes $\psi_{i+1}({\gr z})$ is consistent.
\end{itemize}
Note that \ssf1 and \ssf2 ensure that if ${\gr a}\models\psi_{i+1}({\gr z})$ then $\xi_i({\mr x}\,;{\gr a})$ does not isolate $p({\mr x})$.
Therefore the proof is complete if we can show that it is always possible to find the formula $\phi({\mr x})$ required in \ssf2.

Suppose for a contradiction that no formula makes $\psi_{i+1}({\gr z})$ consistent, that is, 

\ceq{\hfill\xi_i({\mr x}\,;{\gr z})\wedge\psi_i({\gr z})}{\imp}{\phi({\mr x})} 

for every $\phi({\mr x})\in p$.
This immediately implies that 

\ceq{\hfill\E {\gr z}\;\big[\xi_i({\mr x}\,;{\gr z})\wedge\psi_i({\gr z})\big]}{\imp}{p({\mr x}),} 

that is, $p({\mr x})$ is isolated by a formula in $L_{{\mr x}}(A)$.
This contradicts our assumption and proves the lemma.
\end{proof}

\begin{void}[Omitting Types Theorem] Assume $L(A)$ is countable.
Then for every consistent type $p({\mr x})\subseteq L(A)$ the following are equivalent
\begin{itemize}   
\item[1.] all models containing $A$ realize $p({\mr x})$
\item[2.] $A$ isolates $p({\mr x})$.
\end{itemize}
\end{void}

\begin{proof}
The implication \ssf{2}$\IMP$\ssf{1} is clear. 
We prove \ssf{1}$\IMP$\ssf{2}.
Assume that $A$ does not isolate $p({\mr x})$.
The model $M$ is the union of a chain $\<A_i:i<\omega\>$ of countable subsets of $\U$ where $A_0=A$.
Along the construction we require that $A_i$ does not isolate $p({\mr x})$.
At the end, $M$ will not isolate $p({\mr x})$.
Since $M$ is a model, this is equivalent to $M$ omitting $p({\mr x})$.

We proceed as in the proof of the downward L\"owenheim-Skolem theorem.
Assume that $A_i$ does not isolate $p({\mr x})$.
With the notation in the second proof of the L\"owenheim-Skolem Theorem~\ref{thm_lowenheimskolemallingiu}, at stage $i=\pi(j,k)$ apply Lemma~\ref{lem_kuratowskiUlam} to find a solution $a$ of $\phi_k({\mr x})$ such that $A_{i+1}=A_i,a$ does not isolate $p({\mr x})$.
\end{proof}

Gerald Sacks once famously remarked: \textit{Any fool can realize a type, but it takes a model theorist to omit one}.
However, the diagonalization method in the proof of Lemma~\ref{lem_kuratowskiUlam} lean towards descriptive set theory.
(We invite the interested reader to compare this lemma with the Kura\-towski-Ulam theorem.)

\begin{example}\label{ex_AK}
The following example shows that in the omitting types theorem we cannot drop the assumption that $L(A)$ is countable.
Let $F$ be the set of all bijections between two uncountable sets, $X$ and $Y$.
Let $M$ be the model whose domain is domain the disjoint union of $F$, $X$ and $Y$.
The language has a ternary relation symbol for $f(x)=y$ and unary relation symbols for $F$, $X$, and $Y$.
Let $\U$ be a saturated elementary extension of $M$.
Then $\U$ is partitioned into three definable sets $\U_F$, $\U_X$ and $\U_Y$.
Each element of $\U_F$ defines a bijection between $\U_X$ and $\U_Y$.

Note that for any two elements $a,b\in\U_Y$, there is an automorphism of $\U$ that fixes $\U_X\cup\U_Y\sm\{a,b\}$ and swaps $a$ and $b$.

Now, let $Y_0\subseteq\U_Y$ be countable.
Let $c\in\U_Y\sm Y_0$ and let $p(y)=\tp(c/X,Y_0)$.
We claim that $p(y)$ is realized in every model containing $X,Y_0$.
In fact, by the remark above $p(\U)=\U_Y\sm Y_0$.
But every model containing $X$ also contains uncountably many elements of $\U_Y$, hence it contains a conjugate of $c$ which therefore realizes $p(y)$.
We also claim that $p(y)$ is not isolated.
Suppose for a contradiction there is a consistent formula $\phi(y)$ such that $\phi(y)\imp p(y)$.
Then $\phi(y)$ has a solution in $\U_Y\sm Y_0$.
By the remark above, this implies that $\phi(\U)$ is a cofinite subset of $\U_Y$ and this contradicts $\phi(\U)\subseteq p(\U)$.
\end{example}

\begin{exercise}\label{ex_Baire}
Let $p(x)\subseteq L(B)$ and $p_n(x)\subseteq L(A)$, for $n<\omega$, be such that

\ceq{\hfill p(x)}{\imp}{\smash{\bigvee_{i<\omega}p_i(x)}}

Prove that 

\ceq{\hfill p(x)\wedge\phi(x)}{\imp}{p_n(x)}

for some $n<\omega$ and some formula $\phi(x)\in L(A)$ consistent with $p(x)$.
\end{exercise}

\begin{comment}
\begin{exercise}
Let $M$ be a second countable topological space (i.e.\@ the topology has a countable base).
We say that $A\subseteq M$ is meager if it is the countable union of nowhere dense sets.

Use Lemma~\ref{lem_kuratowskiUlam} to prove the Kuratowski-Ulam Theorem, i.e.\@ that for $A\subseteq M^2$ the following are equivalent
\begin{itemize}
\item[1.] $A$ is meager in $M^2$  with the product topology
\item[2.] $\Big\{x\in M : A\cap \{x\}{\times}M \ \textrm{is not meager}\Big\}$ is meager in $M$.
\end{itemize}
Hint: Use the base of the topology as predicates of a first-order language.
\end{exercise}
\end{comment}

\begin{exercise} 
  Let $A\subseteq B$ and $p(x)\subseteq L(A)$. 
  Suppose that $\tp(a/B)$ is isolated over $B$ for every $a\models p(x)$.
  Prove that $p(x)$ is isolated over $A$.
  % \def\ceq#1#2#3{\parbox[b]{15ex}{$\displaystyle #1$}\parbox[b]{6ex}{\hfil$#2$}$\displaystyle #3$}
  % Hint. 
  
  % \ceq{\hfill p(x)}{\iff}{\bigvee\Big\{q(x)\in S(B)\ :\ q(x){\rm\ consistent\ with\ } p(x)\Big\}}
  
  % As all these types $q(x)$ are isolated, 
  
  
  % \ceq{\hfill p(x)}{\iff}{\bigvee\Big\{\phi(x)\in L(B)\ :\ \phi(x){\rm\ complete\ formula\ consistent\ with\ } p(x)\Big\}}
  
  
  % By compactness, for some $\phi_1(x)\dots,\phi_n(x)\in L(A)$ 
  
  % \ceq{\hfill p(x)}{\iff}{\bigvee^n_{i=1}\phi_i(x)}
  
  % (compactness yields $\imp$, while $\pmi$ is clear by the completeness of $\phi_i(x)$).
  % Again by compactness, there is a formula $\psi(x)\in p$ such that
  
  % \ceq{\hfill\psi(x)}{\iff}{\bigvee^n_{i=1}\phi_i(x)}
  \end{exercise}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Prime and atomic models}

We say that $M$ is \emph{prime over $A$\/} if $A\subseteq M$ and for every $N$ containing $A$ there is an elementary embedding $h:M\to N$ that fixes $A$.
When $A$ is empty we simply say that $M$ is \emph{prime}.

There is no syntactic analogue of primeness.
The closest notion, which works well for countable models in a countable language, is atomicity.
For ${\mr a}\in\U^{\mr x}$ we say that ${\mr a}$ is  \emph{isolated\/} over $A$ if the type $p({\mr x})=\tp({\mr a}/A)$ is isolated.
Note that this equivalent to claiming that ${\mr a}$ is an isolated point in $\U^{\mr x}$ with respect to the $A$-topology defined in Section~\ref{monster}.
We say that $M$ is \emph{atomic\/} over $A$ if $A\subseteq M$ and every ${\mr a}\in M^{<\omega}$ is isolated over $A$.
When $A$ is empty we say that $M$ is \emph{atomic.}

% \begin{proposition}
% Let ${\mr b}$ and ${\gr a}$ be finite tuples.
%Let $p({\mr x},{\gr z})=\tp ({\mr b},{\gr a}/A)$ then the following are equivalent
% \begin{itemize}
% \item[1.] $A$ isolates $p({\mr x},{\gr z})$;
% \item[2.] $A,{\gr a}$ isolates $p({\mr x},{\gr a})$ and $A$ isolates $\E {\mr x}\, p({\mr x},{\gr z})$.
% \end{itemize}
% \end{proposition}

\begin{proposition}
Let ${\gr a}$ and ${\mr b}$ be finite tuples.
Then the following are equivalent
\begin{itemize}
\item[1.] $A$ isolates  ${\mr b},{\gr a}$
\item[2.] $A,{\gr a}$ isolates ${\mr b}$ and $A$ isolates ${\gr a}$.
\end{itemize}
\end{proposition}
\begin{proof}
Note that, if $p({\mr x},{\gr z})=\tp ({\mr b},{\gr a}/A)$, then $p({\mr x},{\gr a})=\tp({\mr b}/A,{\gr a})$ and $\E{\mr x}\,p({\mr x},{\gr z})$ equivalent to $\tp({\gr a}/A)$.


\ssf{1}$\IMP$\ssf{2}. Let $\phi({\mr x},{\gr z})\in p$ be such that $\phi({\mr x},{\gr z})\imp p({\mr x},{\gr z})$.
Then $\phi({\mr x},{\gr a})\imp p({\mr x},{\gr a})$ and $\E{\mr x}\, \phi({\mr x},{\gr z})\imp \E{\mr x}\,p({\mr x},{\gr z})$.
Therefore \ssf{2} holds by the remark above.

\ssf{2}$\IMP$\ssf{1}. Fix $\phi({\mr x}\,;{\gr z}), \psi({\gr z})\in L(A)$ such that $\phi({\mr x}\,;{\gr a})$ isolates $p({\mr x}\,;{\gr a})$ and $\psi({\gr z})$ isolates $\E {\mr x}\, p({\mr x}\,;{\gr z})$.
Let $\xi({\mr x}\,;{\gr z})\in p$ be arbitrary.
As $\phi({\mr x}\,;{\gr a})\imp\xi({\mr x}\,;{\gr a})$, the formula $\A{\mr x}\,\big[\phi({\mr x}\,;{\gr z})\imp\xi({\mr x}\,;{\gr z})\big]$ belongs to $\tp({\gr a}/A)$ which, as noted above, coincides with $\E {\mr x}\, p({\mr x},{\gr z})$.
Hence $\psi({\gr z})\imp\A{\mr x}\,\big[\phi({\mr x}\,;{\gr z})\imp\xi({\mr x}\,;{\gr z})\big]$.
As this holds for all $\xi({\mr x}\,;{\gr z})\in p$, we conclude that $\psi({\gr z})\wedge\phi({\mr x}\,;{\gr z})$ isolates  $p({\mr x},{\gr z})$.
\end{proof}

Implication \ssf{1}$\IMP$\ssf{2} of the proposition above yields the following useful proposition.

\begin{proposition}\label{prop_atomic_over_Aa}
If $M$ is atomic over $A$ then $M$ is atomic over $A,{\gr a}$ for any ${\gr a}\in M^{<\omega}$.
\end{proposition}
\begin{proof}
Let ${\mr b}\in M^{\mr x}$ be a finite tuple.
Then $A$ isolates ${\mr b},{\gr a}$  hence $A,{\gr a}$ isolates ${\mr b}$.
\end{proof}

\begin{proposition}\label{prop_atomic_extension}
Let $k:M\to N$ be an elementary map and suppose that $M$ is atomic over $\dom k$.
Then for every ${\mr b}\in M$ there is a ${\mr c}\in N$ such that $k\cup\big\{\<{\mr b},{\mr c}\>\big\}:M\to N$ is elementary.
\end{proposition}

\begin{proof}
Let $p({\mr x}\,;{\gr z})=\tp({\mr b}\,;{\gr a})$ where ${\gr a}$ is an enumeration of $\dom k$.
Let $\phi({\mr x}\,;{\gr z})\in L$ be such that $\phi({\mr x}\,;{\gr a})\imp p({\mr x}\,;{\gr a})$.
Note that, by elementarity, $\phi({\mr x}\,;k{\gr a})\imp p({\mr x}\,;k{\gr a})$.
Hence the required ${\mr c}$ is any solution of $\phi({\mr x}\,;k{\gr a})$ in $N$.
\end{proof}

A limiting assumption in Proposition~\ref{prop_atomic_over_Aa} is that ${\gr a}$ need to be finite.
Therefore the following proposition is restricted to countable models.

\begin{proposition}\label{prop_atomic_unique}
Any two countable models atomic over $A$ are isomorphic.
\end{proposition}

\begin{proof}
By Propositions~\ref{prop_atomic_over_Aa} and~\ref{prop_atomic_extension} and an easy back-and-forth argument.
\end{proof}

\begin{proposition} 
Assume $L(A)$ is countable.
Then for every model $M$ the following are equivalent
\begin{itemize}
\item[1.] $M$ is countable and atomic over $A$
\item[2.] $M$ is prime over $A$.
\end{itemize}
\end{proposition}

\begin{proof}
\ssf{1}$\IMP$\ssf{2}. By Propositions~\ref{prop_atomic_over_Aa} and~\ref{prop_atomic_extension}.

\ssf{2}$\IMP$\ssf{1}. Some countable model containing $A$ exists, as $M$ embeds in it, $M$ has also to be countable.
Now we prove that $M$ is atomic over $A$.
Suppose for a contradiction that there is some ${\mr b}\in M^{<\omega}$ such that $p({\mr x})=\tp({\mr b}/A)$ is not isolated.
By the omitting types theorem there is a model $N$ containing $A$ that omits $p({\mr x})$.
Then there cannot be any $A$-elementary embedding of $M$ into $N$.
\end{proof}

\begin{proposition}\label{prop_idolated_type_dense}
Assume $L(A)$ is countable.
Then the following are equivalent
\begin{itemize}
\item[1.] there are models atomic over $A$
\item[2.] every consistent $\phi({\gr z})\in L(A)$ has a solution that is isolated over $A$.
\end{itemize}
\end{proposition} 
Note that \ssf{2} says that in $\U^{\gr z}$ isolated points are dense w.r.t.\@ the topology defined in Section~\ref{monster}.

\vspace*{-\parskip}
\begin{proof}
\ssf{1}$\IMP$\ssf{2}. This holds by elementarity.

\ssf{2}$\IMP$\ssf{1}. We construct by induction a sequence $\<{a_i}:i<\omega\>$.
Reasoning as in (the second proof of) the downward L\"overheim-Skolem theorem we can easily ensure that $A\cup\big\{{a_i}:i<\omega\big\}$ is a model.
To obtain an atomic model we require that ${\gr a_{\restriction i}}$ is isolated over $A$.


Suppose ${\gr a_{\restriction i}}$ has been defined and assume that some formula $\phi({\gr z})\in L(A)$ isolates $\tp({\gr a_{\restriction i}}/A)$.
Let $\psi({x}\,;{\gr z})\in L(A)$ be such that $\psi({x}\,;{\gr a_{\restriction i}})$ is consistent (we leave to the reader the details of the enumeration of such formulas).
Then $\psi({x}\,;{\gr z})\wedge\phi({\gr z})$ is also consistent and by assumption it has a solution ${b}\,;{\gr c}$ that is isolated over $A$.
As ${\gr a_{\restriction i}}\equiv_A{\gr c}$, there is an $A$-automorphism such that $f{\gr c}={\gr a_{\restriction i}}$.
Therefore $f{b}\,;{\gr a_{\restriction i}}$ is a solution $\psi({x}\,;{\gr z})$ that is also isolated over $A$.
Then we can set ${a_i}=f{b}$.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Countable categoricity}

Here we present some important characterizations of $\omega$-categoricity.
The second property below can be stated in different equivalent ways; for convenience, these equivalents are considered in a separate proposition.
For the time being we introduce the following generalization (which we will prove is completely unnecessary): we say hat $T$ is $\omega$-categorical over $A$ if any two countable models containing $A$ are isomorphic over $A$.
We say $\omega$-categorical for $\omega$-categorical over $\varnothing$.

\begin{theorem}[ (Engeler, Ryll-Nardzewsky, and Svenonius)] Assume $L(A)$ is countable.
The following are equivalent:
\begin{itemize}   
\item[1.] $T$ is $\omega$-categorical over $A$
\item[2.] every type $p({\mr x})\subseteq L(A)$ with $|{\mr x}|<\omega$ is isolated.

\end{itemize}
\end{theorem}
The set $A$ is introduced for convenience.
By \ssf{3} of Proposition~\ref{prop_ERNS_equivalents} below, no theory is $\omega$-categorical over an infinite set, and categoricity over some finite $A$ is equivalent to categoricity over $\varnothing$ (see Exercise~\ref{ex_omega_cat_overA}).

\vspace*{-\parskip}
\begin{proof} \ssf{1}$\IMP$\ssf{2}. This is an immediate consequence of the omitting types theorem.
In fact, if $p({\mr x})$ is a non-isolated $A$-type, then there are two countable models $M$ and $N$ containing $A$ such that $M$ realizes $p({\mr x})\subseteq L(A)$ while $N$ omits it.
Then $M$ and $N$ cannot be isomorphic over $A$.

\ssf{2}$\IMP$\ssf{1}. Observe that \ssf{2} implies that every countable model containing $A$ is atomic over $A$.
But, by Proposition~\ref{prop_atomic_unique}, countable atomic models are unique up to isomorphism.
\end{proof}

\begin{proposition}\label{prop_ERNS_equivalents}
Fix a set $A$ and a finite tuple of variables ${\mr x}$.
The following are equivalent\nobreak
\begin{itemize}   
\item[1.] every type $p({\mr x})\subseteq L(A)$ is isolated
\item[2.] $S_{\mr x}(A)$ is finite
\item[3.] $L_{\mr x}(A)$ is finite up to equivalence
\item[4.] $\Aut(\U/A)$ induces finitely many orbits in $\U^{\mr x}$.
\end{itemize}
\end{proposition}
\begin{proof}To prove the implication \ssf{1}$\IMP$\ssf{2} observe that $\U^{\mr x}$ is the union of sets of the form $p(\U)$ where $p\in S_{\mr x}(A)$.
If these types are isolated then $\U^{\mr x}$ is the union of $A$-definable sets.
By compactness this union has to be finite.
To prove \ssf{2}$\IMP$\ssf{1} let $p\in S_{\mr x}(A)$.
If $S_{\mr x}(A)$ is finite, $\neg p(\U)$ is the union of finitely many type definable sets.
A finite union of type definable sets is type definable.
So $\neg p(\U)$ is type definable.
Hence $p(\U)$ is isolated.
We prove implication \ssf{2}$\IMP$\ssf{3} observe that each formula in $L_{\mr x}(A)$ is equivalent to the disjunction of the types in $S_{\mr x}(A)$ that contain this formula.
If $S_{\mr x}(A)$ is finite, $L_{\mr x}(A)$ is finite up to equivalence.
Implication \ssf{3}$\IMP$\ssf{2} is clear and equivalence \ssf{2}$\IFF$\ssf{4} follows from the characterization of orbits as type-definable sets.
\end{proof}

\begin{exercise}\label{ex_oligomorphic}
   Prove that the following are equivalent
   \begin{itemize}   
   \item[1.] $T$ is $\omega$-categorical
   \item[2.] for every $M$ countable and $x$ finite, $\Aut(M)$ induces finitely many orbits in $M^x$.
   \end{itemize}
\end{exercise}

\begin{exercise}\label{ex_omega_cat_overA}
Prove that the following are equivalent for every finite set $A$
\begin{itemize}   
\item[1.] $T$ is $\omega$-categorical
\item[2.] $T$ is $\omega$-categorical over $A$.
\end{itemize}
\end{exercise}

\begin{exercise}\label{ex_omega_cat_sat=atomic}
Prove that the following are equivalent
\begin{itemize}   
\item[1.] $T$ is $\omega$-categorical
\item[2.] there is a countable model that is both saturated and atomic. 
\end{itemize}
\end{exercise}

\begin{exercise} 
Assume $L$ is countable and that $T$ is complete.
Suppose that for every finite tuple $x$ there is a model $M$ that realizes only finitely many types in $S_x(T)$.
Prove that $T$ is $\omega$-categorical.
\end{exercise}

\begin{exercise}
A countable structure $M$ is \textit{set-ultrahomogeneous\/} if for every finite partial embedding $k:M\to M$ there is an $h\in\Aut(M)$ such that $h[\dom k]=\range k$.
Prove that if $L$ contains only a finite number of relational symbols, then set-homogeneous models have an $\omega$-categorical theory.
\end{exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Small theories}

\def\ceq#1#2#3{\parbox[b]{15ex}{$\displaystyle #1$}\parbox[b]{6ex}{\hfil$#2$}$\displaystyle #3$}

Let $T$ be, as always in this chapter, a complete theory without finite models.
We say that $T$ is \emph{small over $A$\/} if $S_{{\mr x}}(A)$ is countable for every ${\mr x}$ of finite length.
When $A$ is empty, we simply say that $T$ is \emph{small.}
The set $A$ is introduced for convenience; in most application $A$ is the empty set.
A different term is used in another very interesting case: a theory which is small over every countable set $A$ is said to be $\omega$-stable.
For this reason, the term $0$-stable is sometimes used for small.

\begin{proposition}
If $T$ is small over $A$ then it is small over $A\cup B$ for any finite set $B$.
\end{proposition}

\begin{proof}
Let ${\gr b}$ be an enumeration of $B$.
As $S_{\mr x}(A,B)=\big\{p({\mr x}\,;{\gr b})\ :\ p\in S_{{\mr x}\,;\,{\gr z}}(A)\big\}$ the proposition is immediate.
\end{proof}

Below we identify $S_{\mr x}(A)$ with $\U^{\mr x}/\mathord\equiv_A$

\begin{definition}\label{def_tree_formulas}
Let $\Delta$ be a set of formulas (we mainly use $\Delta=L_{\mr x}(A)$ in this section).
A \emph{binary tree of formulas in $\Delta$\/} is a sequence $\<\phi_s({\mr x})\ :\ s\in2^{<\lambda}\>$ of formulas in $\Delta\cup\{\top\}$ such that\nobreak
\begin{itemize}
\item[1.] for each $s\in 2^\lambda$ the type $p_s({\mr x})\ =\ \big\{\phi_{s\restriction i}({\mr x})\ :\ i<\lambda\big\}$ is consistent
\item[2.] $p_s({\mr x})\cup p_r({\mr x})$ is inconsistent for any two distinct $s,r\in 2^\lambda$.
\end{itemize}
(Condition \ssf{2} is usually obtained by taking $\phi_{s0}({\mr x})\iff\neg\phi_{s1}({\mr x})$ for every $s$.)
We call $\lambda$ the height of the tree.
If the height is not specified, we assume it is $\omega$.
We may depict a binary tree of formulas as follows
\vskip-0.5\baselineskip

% Set the overall layout of the tree
\tikzstyle{level 1}=[level distance=3.5cm, sibling distance=2cm]
\tikzstyle{level 2}=[level distance=3.5cm, sibling distance=1cm]
\tikzstyle{level 3}=[level distance=1.5cm, sibling distance=.5cm]

% Define styles for bags and leafs
\tikzstyle{bag} = [text width=6ex, text centered]
\tikzstyle{end} = [circle, minimum width=3pt,fill, inner sep=0pt]

\def\leaf{...}

\qquad
\begin{tikzpicture}[grow=right]
\node[bag] {$\phi_\varnothing$}
    child {
        node[bag] {$\phi_0$}        
            child {
                node[bag] {$\phi_{00}$}
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }    
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }  
                 edge from parent
            }
            child {
                node[bag] {$\phi_{01}$}
                edge from parent
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }    
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }  
                 edge from parent
            }
       edge from parent 
    }
    child {
        node[bag] {$\phi_1$}         
            child {
                node[bag] {$\phi_{10}$}
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }    
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }  
                 edge from parent
            }
            child {
                node[bag] {$\phi_{11}$}
                edge from parent
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }    
                    child {
                       node[label=right: {\leaf}] {}
                       edge from parent
                    }  
                 edge from parent
            } 
        edge from parent
    };
\end{tikzpicture}

where branches are consistent types and distinct branches are inconsistent.
\end{definition}

Let $S(\Delta)$ denote the set of maximal consistent $\Delta$-types.

\begin{lemma}\label{lem_bin_tree}
Suppose $\Delta$ is countable and closed under negation.
Then the following are equivalent\nobreak
\begin{itemize}   
\item[1.] there is a binary tree of formulas in $\Delta$
\item[2.] $\big|S(\Delta)\big|=2^\omega$
\item[3.] $\big|S(\Delta)\big|>\omega$.
\end{itemize}
\end{lemma}
\begin{proof}
Since the implications \ssf{1}$\IMP$\ssf{2}$\IMP$\ssf{3} are clear, it
suffices to prove \ssf{3}$\IMP$\ssf{1}.
We assume that $S(\Delta)$ is uncountable and define a tree of
formulas in $\Delta$ by induction.
Begin with $\phi_\varnothing=\top$.
For $s\in 2^{<\omega}$ define

\ceq{\hfill p_s({\mr x})}{=}{\big\{\phi_r({\mr x})\ :\ r\subseteq s\big\}.}

Assume inductively that $p_s({\mr x})$ has uncountably many extensions in $S(\Delta)$.
This will guarantee the consistency of the branches.

It suffices to show that there is a formula $\psi({\mr x})\in\Delta$ such that
both $p_s({\mr x})\cup\{\psi({\mr x})\}$ and $p_s({\mr x})\cup\{\neg\psi({\mr x})\}$ have uncountably many
extensions in $S(\Delta)$.
Then we define $\phi_{s^\frown0}({\mr x})=\psi({\mr x})$ and $\phi_{s^\frown1}({\mr x})=\neg\psi({\mr x})$.

Consider the following type that extends $p_s({\mr x})$

\ceq{\hfill q({\mr x})}{=}{\Big\{\xi({\mr x})\in\Delta\ :\ p_s({\mr x})\cup\{\neg\xi({\mr x})\} \textrm{
has }\le\omega\textrm{ extensions in }S(\Delta)\Big\}.}

This type is consistent, otherwise 

\ceq{\hfill p_s({\mr x})}{\imp}{\neg\xi_1({\mr x})\vee\dots\vee\neg\xi_n({\mr x})}

would hold for some $\xi_i({\mr x}) \in q$.
This cannot happen, because $p_s({\mr x})$ has uncountably many extensions in
$S(\Delta)$, while by the definition of $q$ each of
$p_s({\mr x})\cup\{\neg\xi_i({\mr x})\}$ has countably many extensions.

If the formula $\psi({\mr x})$ required above does not exist, $q({\mr x})$ is complete,
hence it belongs to $S(\Delta)$.
Every type in $S(\Delta)$ that extends $p_s({\mr x})$ and is distinct from $q({\mr x})$
contains $p_s({\mr x})\cup\{\neg\xi({\mr x})\}$ for some $\xi({\mr x})\in q({\mr x})$.
By the definition of $q({\mr x})$, there are countably many such types,
so this contradicts the induction hypothesis.
\end{proof}


\begin{proposition}\label{prop_small_equivalents}
Suppose $L(A)$ is countable.
The following are equivalent\nobreak
\begin{itemize}   
\item[1.] $T$ is small over $A$
\item[2.] there exists a countable saturated model containing $A$
\item[3.] there is no binary tree of formulas in $L_{\mr x}(A)$ for any finite ${\mr x}$.
\end{itemize}
\end{proposition}
\begin{proof}\ssf{1}$\IMP$\ssf{2}. There is a countable model $M$ containing $A$ that is weakly saturated (see Proposition~\ref{prop_w_saturation}).
There is a countable homogeneous model $N$ containing $M$ (see Exercise~\ref{saturo=universaledebolmenteomogeneo}).
Clearly $N$ is also weakly saturated.
Then it is saturated by Corollary~\ref{saturo=universaledebolmenteomogeneo}.

For a direct argument: construct a countable chain of countable models $M_i$ such that $M_{i+1}$ realized all types in $S_{\mr x}(A,B)$ for every finite $B\subseteq M_i$ and ${\mr x}$.
The union of the chain is the saturated model that proves \ssf2.


\ssf{2}$\IMP$\ssf{3}. Clear.

\ssf{3}$\IMP$\ssf{1}. By Lemma~\ref{lem_bin_tree}.
\end{proof}


\begin{proposition} 
A small theory has atomic models over $A$ for any countable $A$.
\end{proposition}
\begin{proof}
We prove that every formula in $L_{\mr x}(A)$, where ${\mr x}$ is finite, has a solution isolated over $A$.
Then it suffices to apply Proposition~\ref{prop_idolated_type_dense}.

Suppose for a contradiction that $\phi({\mr x})\in L(A)$ is consistent but has no solution isolated over $A$.
Then there is a formula $\psi({\mr x})\in L(A)$ such that both $\phi({\mr x})\wedge\psi({\mr x})$ and $\phi({\mr x})\wedge\neg\psi({\mr x})$ are consistent, otherwise $\phi({\mr x})$ would imply a complete type and every solution of $\phi({\mr x})$ would be isolated.
Fix such a $\psi({\mr x})$.
Clearly neither $\phi({\mr x})\wedge\psi({\mr x})$ nor $\phi({\mr x})\wedge\neg\psi({\mr x})$ have a solution isolated over $A$.
This allows to construct a binary tree of formulas in $L_{\mr x}(A)$ and prove that $T$ is not small over $A$.
\end{proof}

% \begin{exercise}\label{ex_binary_tree_canonical}
% Suppose $\Delta$ is countable and closed under negation.
% Prove that if there is a binary tree of formulas  then there is a binary tree such that $\phi_{s0}=\neg\phi_{s1}$ and $\phi_{\varnothing}=\top$.
% \end{exercise}

\begin{exercise}
Let $|{\mr x}|=1$.
Prove that if $S_{{\mr x}}(A)$ is countable for every finite set $A$, then $T$ is small.
\end{exercise}

\begin{exercise}[ (Vaught)]
Prove that no complete theory has exactly 2 countable models (assume $L$ is countable~--~though it is not really necessary).

Hint: suppose $T$ has exactly two countable models.
Then $T$ is small.
Therefore, there is a countable saturated model $N$ and an atomic model $M\subseteq N$.
As $T$ is not $\omega$-categorical, $M\not\simeq N$ and there is finite tuple $a$ that is not isolated over $\varnothing$.
Let $K$ be an atomic model over $a$.
Clearly $K\not\simeq M$ and, by Exercises~\ref{ex_omega_cat_overA} and~\ref{ex_omega_cat_sat=atomic}, also $K\not\simeq N$.
\end{exercise}

%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%
\section{A toy version of a theorem of Zil'ber}\label{toy}

Recall that $T$ is a complete theory without finite models.
As an application we prove that if $T$ is $\omega$-categorical and strongly minimal then it is not finitely axiomatizable.

We say that $T$ has the \emph{finite model property\/} if for every sentence $\phi\in L$ there is a finite substructure $A\subseteq\U$ such that 

\ceq{\ssf{fmp}\hfill\U\models\phi}{\IFF}{A\models\phi}

The property is interesting to us because of the following proposition.

\begin{proposition}\label{prop_fmp_fa}
If $T$ has the finite model property then it is not finitely axiomatizable.
\end{proposition}
\begin{proof}
Assume \ssf{fmp} and suppose for a contradiction that there is a sentence $\phi\in L$ such that $T\proves\phi\proves T$.
Then $A\models T$ for some finite structure $A$.
But $T\proves \E^{>k}x\,(x=x)$ for every $k$.
A contradiction.
\end{proof}
We need the following definition.
We say that $C\subseteq\U$ is a \emph{homogeneous set\/} if for every finite elementary map $k:C\to C$ and every ${\mr b}\in C$ there is a ${\mr c}\in C$ such that $k\cup\{\<{\mr b},{\mr c}\>\}$ is elementary.

\begin{proposition}\label{prop_zilbergiocattolo}
  ($T$ strongly minimal.)
  Every algebraically closed set of finite dimension is homogeneous.
\end{proposition}
\begin{proof}
  Let $k:A\to A$ be elementary.
  Assume $A$ is algebraically closed and pick ${\mr b}\in A$.
  If ${\mr b}\in\acl(\dom k)$, then by Proposition~\ref{prop_estensionemappechiusuraalgebrica} there is an $f\in\Aut(\U)$ that extends $k$ and is such that $f({\mr b})\in\acl(\range k)\subseteq A$.
  Then ${\mr c}=f{\mr b}$ is as required.
  If ${\mr b}\notin\acl(\dom k)$, then $\dim(\dom k)<\dim A$.
  Therefore also  $\dim(\range k)<\dim A$.
  Then we can pick any ${\mr c}\in A\sm\range k$.
\end{proof}

\begin{lemma}\label{lem_zilbergiocattolo} 
  ($T$ strongly minimal.)
  If $T$ is $\omega$-categorical then $T$ has the finite model property.
\end{lemma}
\begin{proof}
  We prove \ssf{fmp} also for formulas with parameters.
  Namely, we prove that for every $n$ there is a finite structure $A\subseteq\U$ such that \ssf{fmp} holds for all sentences $\phi\in L(A)$ such that

  $\#_n$\hfil number of parameters in $\phi$\ \ $+$\ \ number of quantifiers in $\phi$\ \ $\le\ n$.

  Fix $n$ and pick some finite algebraically closed set $A$ such that all types $p(z)\subseteq L$ with $|z|\le n$ have a realization in $A^z$.
  Recall that the algebraic closure is always a substructure and that, in an $\omega$-categorical theory, finite sets have finite algebraic closure. 
  Now we prove that $A\models\phi$ for every $\phi$ as in $\#_n$.

  Proceed by induction on the syntax of $\phi$.
  The claim is clear for atomic formulas.
  Induction for Boolean connectives is straightforward.
  As for induction step for the existential quantifier, consider the formula $\E {\mr x}\,\phi({\mr x}\,;{\gr a})$, where ${\gr a}\in A^{<n}$ and $|{\mr x}|=1$.
  Implication $\PMI$ of \ssf{fmp} follows immediately from the induction hypothesis and from the fact that, if $\E {\mr x}\,\phi({\mr x}\,;{\gr a})$ satisfy $\#_n$, also $\phi({\mr b}\,;{\gr a})$ satisfies it.
  As for $\IMP$, assume that $\U\models\E {\mr x}\, \phi({\mr x}\,;{\gr a})$.
  Let ${\mr b},{\gr a'}\in A^{{\mr x}\,{\gr z}}$ be a solution of $\phi({\mr x}\,;{\gr z})$ such that ${\gr a}\equiv{\gr a'}$.
  Such a solution exists because all types with $\le n$ variables are realized in $A$.
  As $A$ is a homogeneous set (apply the definition with $k=\{\<{\gr a'},{\gr a}\>\}$),  there is a ${\mr c}\in A$ such that ${\gr a},{\mr c}\equiv {\gr a'},{\mr b}$.
  Therefore $A\models\phi({\mr c}\,;{\gr a})$ follows by induction hypothesis.
  % Finally consider the case when $L$ contains functions symbols.
  % Now we also need to check that $A$ is a structure.
  % This is true in general but, for simplicity we add to \ssf{\#} the requirement that all function symbols in $L$ have arity $<n$.
  % Note that if all types $p(z)\subseteq L$ with $|z|\le n$ have a realization in $A^z$, then $A$ is a substructure w.r.t.\@ a fragment which only contains functions of arity $< n$.
\end{proof}

\begin{theorem}\label{thm_zilbergiocattolo}
  ($T$ strongly minimal.)
  If $T$ is $\omega$-categorical then it is not finitely axiomatizable.
\end{theorem} 

\begin{exercise} 
Assume $L$ is countable and let $T$ be strongly minimal.
Prove that the following are equivalent
\begin{itemize}
\item[1.] $T$ is $\omega$-categorical
\item[2.] the algebraic closure of a finite set is finite.
\end{itemize}
Implication \ssf{1}$\IMP$\ssf{2} does not require the strong minimality of $T$.
\end{exercise}

\begin{exercise} 
  Let $T$ be $\omega$-categorical.
  Prove that if all algebraically closed sets are homogeneous, then $T$ is not finitely axiomatizable.
\end{exercise}

\section{Notes and references}
\label{Notes_countable}
An uncountable, non-isolated, complete type that cannot be omitted was produced by Gebhard Fuhrken in 1962.
Example~\ref{ex_AK} is inspired by a post by Alex Kruckman on StackExhange~\cite{AK}.
I am not aware of other expositions.

Boris Zil'ber famously proved that Theorem~\ref{thm_zilbergiocattolo} holds for any totally categorical theory.
The same theorem has been proved independently by Cherlin, Harrington and Lachlan.
Their proof uses the classification of finite simple groups.
This theorem marks the birth of a subject known as \textit{geometric stability theory\/} which studies in depth the geometric properties which we briefly mentioned in Chapter~\ref{geometria}.
The interested reader may consult Pillay's monograph~\cite{Pillay}. 
The material in Section~\ref{toy} comes from~\cite{Pillay}*{Section~2.6} 



\begin{biblist}[]\normalsize
\bib{AK}{article}{
  author={Alex Kruckman},
  title={Counterexample to the omitting types in uncountable language},
  eprint={https://math.stackexchange.com/q/2434851},
  note={URL accessed 2019-02-28},
  %status={\href{https://math.stackexchange.com/q/2434851}},
  date={2017},
  }\smallskip 
\bib{Pillay}{book}{
  author={Pillay, Anand},
  title={Geometric stability theory},
  series={Oxford Logic Guides},
  volume={32},
  %note={Oxford Science Publications},
  %publisher={The Clarendon Press, Oxford University Press, New York},
  date={1996},
  % pages={x+361},
}\smallskip
\end{biblist}