% !TEX root = creche.tex
\chapter{Invariant sets}
\label{invariant}

\def\medrel#1{\parbox[t]{5ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox[t]{19ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

In this chapter, $L$ is a signature, $T$ is a complete theory without finite models, and $\U$ is a saturated model of inaccessible cardinality $\kappa$ strictly larger than $|L|$.
We use the same notation and make the same implicit assumptions as in Section~\ref{monster}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Invariant sets and types}\label{invariant_sets}

Let $\grD\subseteq\U^{\gr z}$, where ${\gr z}$ is a tuple of length $<\kappa$.
We say that $\grD$ is \emph{invariant\/} over $A$, or \emph{$A$-invariant\/} for sort, if it is fixed setwise by all $A$-automorphisms.
That is, $f[\grD]=\grD$ for every automorphism $f\in\Aut(\U/A)$ or, yet in other words, if

\ceq{\ssf{is1.}\hfill {\gr a}\in\grD}{\iff}{f{\gr a}\in\grD}\hfill for every ${\gr a}\in\U^{\gr z}$ and every $f\in\Aut(\U/A)$,

which, by homogeneity, is equivalent to,

\ceq{\ssf{is2.}\hfill {\gr a}\in\grD}{\iff}{{\gr b}\in\grD}\hfill for all ${\gr a},{\gr b}\in\U^{\gr z}$ such that ${\gr a}\equiv_A{\gr b}$.

The latter condition yields the following bound on the number of invariant sets.

\begin{proposition}\label{prop_numberIS}
Let $\lambda=|L_{\gr z}(A)|$.
There are at most $2^{2^{\lambda}}$ sets $\grD\subseteq\U^{\gr z}$ that are invariant over $A$.
\end{proposition}
\begin{proof}
By \ssf{is2}, sets that are invariant over $A$ are unions of equivalence classes of the relation $\equiv_A$, that is, unions of sets of the form $p({\gr\U})$ where $p({\gr z})\in S(A)$.
Then the number of $A$-invariant sets is at most $2^{|S_{\gr z}(A)|}$.
Clearly $|S_{\gr z}(A)|\le 2^\lambda$.
\end{proof} 

A formula is invariant if the set it defines is invariant.
The same for small types.

For non-small types the definition of invariant type is less straightforward.
One is tempted to require that the formulas in the type are invariant~--~but this is too strong a demand as it implies that the type is small.
% Alternatively, one could require that the set defined by the type is invariant.
% Though this is closer in spirit to the definition below but, as stated it would meaninless for large types that are not realized in $\U$.
Alternatively, one could require that the set defined by the type is invariant~--~but this is an empty requirement for types that are not realized in $\U$.

First we introduce some notation.
Let $\phi({\mr x}\,;{\gr z})\in L(\U)$.
A \emph{$\phi$-formula\/} is a Boolean combination of formulas of the form $\phi({\mr x}\,;{\gr b})$ for some ${\gr b}\in\U^{\gr z}$.
A \emph{$\phi$-type\/} is a set of $\phi$-formulas.
We denote by \emph{$S_\phi(\Aa)$\/} the set of complete $\phi$-types that contain $\phi$-formulas that are invariant over $\Aa$.
Typically, $\Aa$ is either $\U$ or some small set $A\subseteq\U$.
Types in \emph{$S_{\phi}(\U)$\/} are called \emph{global $\phi$-types.}

Let $p({\mr x})\subseteq L(\U)$.
For $f\in\Aut(\U)$, we write $fp({\mr x})$ for the type containing the formulas $\phi({\mr x}\,;f{\gr a})$ for every $\phi({\mr x}\,;{\gr a})\in p$, where $\phi({\mr x}\,;{\gr z})\in L$.
We say that $p({\mr x})$ is \emph{invariant\/} over $A$, or \emph{$A$-invariant\/} for short, if for every $f\in\Aut(\U/A)$

\ceq{\ssf{it1.}\hfill p({\mr x})}{\proves}{fp({\mr x})}

Equivalently, if for every $\phi({\mr x}\,;{\gr z})\in L(A)$, every ${\gr a}\in\U^{\gr z}$, and every $f\in\Aut(\U/A)$

\ceq{\ssf{it1$'$.}\hfill p({\mr x})\proves\phi({\mr x}\,;{\gr a})}{\IFF}{p({\mr x})\proves\phi({\mr x}\,;f{\gr a})}.

% They may be identified with subsets of $\U^{\gr z}$.
% Namely, $p({\mr x})\in S_\phi(\Aa)$ is identified with
   
% \ceq{\hfill\grD}{=}{\Big\{{\gr b}\in\Aa^{\gr z}\ :\ \phi({\mr x}\,;{\gr b})\in p\Big\}.}

% \begin{proposition}
% Suppose $M$ realizes every consistent type $p({\gr z})\subseteq L(A)$.
% Let $D\subseteq M^{\gr z}$ be such that \ssf{is2} holds for $D$ when restricted to ${\gr a},{\gr b}\in M^{\gr z}$.
% Then $D$ is the trace on $M$ of some unique $A$-invariant set $\grD$.
% \end{proposition}
% 
% \begin{proof}
% The set $\grD$ is the union, for $p({\gr z})\in S(A)$, of the sets $p(\U)$ that intersect $D$.
% \end{proof}

Let $p({\mr x})\in S(\U)$ be a global type.
For every formula $\phi({\mr x}\,;{\gr z})\in L(\U)$ we define

\ceq{\hfill\emph{$\gr\D_{p,\phi}$}}{=}{\Big\{{\gr a}\in\U^{\gr z}\ :\ p({\mr x})\proves\phi({\mr x}\,;{\gr a})\Big\}.}

% We can read the notation in two ways: either the tuple ${\gr z}$ has length $\omega$ and is the same for all formulas, or it is finite and depends on $\phi$.
% This is possible because adding or erasing dummy variables to the tuple of ${\gr z}$ does not change ${\gr\D_{p,\phi}}$ in any relevant way; in particular, invariance is preserved.


A global $\phi$-type $p({\mr x})\in S_\phi(\U)$ can be identified with the set ${\gr\D_{p,\phi}}$.
Therefore a global type $p({\mr x})\in S(\U)$ can be identified with the collection of the sets ${\gr\D_{p,\phi}}$, where $\phi({\mr x}\,;{\gr z})$ ranges over $L$.

Hence $p({\mr x})$ is invariant exactly when all the sets $\gr\D_{p,\phi}$ are.
That is, $p({\mr x})$ is invariant over $A$ if for all $\phi({\mr x}\,;{\gr z})\in L(A)$ and ${\gr a},{\gr b}\in\U^{\gr z}$

\ceq{\ssf{it2.}\hfill  {\gr a}\equiv_A{\gr b}}{\IMP}{\Big(p({\mr x})\proves\phi({\mr x}\,;{\gr a})\,\IFF\,p({\mr x})\proves\phi({\mr x}\,;{\gr b})\Big)}

% In words we say that $p({\mr x})\subseteq L(\U)$ \emph{does not split\/} over $A$.

If $p({\mr x})\in S_\phi(\U)$ \ssf{it2} is equivalent to requiring that for every ${\gr a},{\gr b}\in\U^{\gr z}$

\ceq{\ssf{it2$^\prime$.}\hfill  {\gr a}\equiv_A{\gr b}}{\IMP}{p({\mr x})\,\proves\,\phi({\mr x}\,;{\gr a})\iff\phi({\mr x}\,;{\gr b})}.

Finally, note the following useful characterization of \ssf{it2$'$}

\ceq{\ssf{it3.}\hfill {\gr a}\equiv_A{\gr b}}{\IMP}{\phi({\mr c}\,;{\gr a})\iff\phi({\mr c}\,;{\gr b})}

for every ${\gr a},{\gr b}\in\U^{\gr z}$ and ${\mr c}\models p_{\restriction A,{\gr a},{\gr b}}$.
When $p({\mr x})\in S(\U)$, this can be rephrased as

\ceq{\ssf{it3$'$.}\hfill {\gr a}\equiv_A{\gr b}}{\IMP}{{\gr a}\equiv_{A,\,{\mr c}}{\gr b}}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heirs and coheirs}
\label{coheirs}

\def\medrel#1{\parbox[t]{6ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox[t]{16ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

The easiest way to obtain types that are invariant over $A$ is via types that are finitely satisfiable in $A$.
We say that a type $p({\mr x})$ is \emph{finitely satisfiable\/} in $A$ if every conjunction of formulas in $p({\mr x})$ has a solution in $A^{\mr x}$.

\begin{proposition}\label{prop_coeredi_quasiinvarienti}
  Every $p({\mr x})\in S(\U)$ that is finitely satisfiable in $A$ is invariant over $A$.
\end{proposition}

\begin{proof}
  Suppose not.
  By \ssf{it2$'$} and the completeness of $p({\mr x})$ there are ${\gr a}\equiv_A{\gr b}$ and $\phi({\mr x}\,;{\gr z})\in L$ such that $p({\mr x})\proves\phi({\mr x}\,;{\gr a})\niff\phi({\mr x}\,;{\gr b})$.
  Then the finite satisfiability of $p({\mr x})$ contradicts ${\gr a}\equiv_A{\gr b}$.
\end{proof}

\begin{proposition}\label{prop_exisntence_coheirs}
  Every type $q({\mr x})\subseteq L(\U)$ that is finitely satisfiable in $A$ has an extension to a global type that is finitely satisfiable in $A$.
\end{proposition}

\begin{proof}
  Let $p({\mr x})\subseteq L(\U)$ be maximal among the types that contain $q({\mr x})$ and are finitely satisfiable in $A$.
  We prove that $p({\mr x})$ is complete.
  If for a contradiction $p({\mr x})$ contains neither $\psi({\mr x})$ nor $\neg\psi({\mr x})$, then  neither $p({\mr x})\cup\big\{\psi({\mr x})\big\}$ nor $p({\mr x})\cup\big\{\neg\psi({\mr x})\big\}$ are finitely satisfiable in $A$.
  This contradicts the finite satisfiability of $p({\mr x})$.
\end{proof}

In most cases we work with types that are finitely satisfiable over a model.
The reason is explained by the next proposition, which is clear by elementarity.

\begin{remark}\label{rk_coher_over_model}
  Every consistent type over a model is finitely satisfiable in that model, that is, whenever $p({\mr x})\subseteq L(M)$ is consistent, $p({\mr x})$ is finitely satisfiable in $M$.
\end{remark}

\begin{definition}\label{def_choeir_uno}
  A type $p({\mr x})\subseteq L(\U)$ that is finitely satisfiable in $A$ is said to be a \emph{coheir\/} of $p_{\restriction A}({\mr x})$.
\end{definition}

In many cases it is convenient to work with elements instead of types.
We introduce the following notation to express that $\tp({\mr a}/A,{\gr b})$ is finitely satisfied in $A$.

\begin{definition}\label{def_coheir_idepencence}
  For every ${\mr a}\in\U^{\mr x}$ and ${\gr b}\in\U^{\gr z}$ we define\smallskip

  \noindent\llap{\textcolor{red}{\Large\warning}\kern1.5ex}
  %
  \ceq{\hfill\emph{${\mr a}\cnonfork_A{\gr b}$}}
  {\IFF}
  {\phi(A^{\mr x},{\gr b})\neq\varnothing
  \textrm{ for all }\phi({\mr x}\,;{\gr z})\in L(A) 
  \textrm{ such that }\phi({\mr a}\,;{\gr b})}.\smallskip

  We say that $\tp({\mr a}/A,{\gr b})$ is a \emph{coheir} of $\tp({\mr a}/A)$ or, equivalently, that $\tp({\gr b}/A,{\mr a})$ is an \emph{heir} of $\tp({\gr b}/A)$.
  We define the type\smallskip

  \ceq{\hfill\emph{${\mr x}\cnonfork_A{\gr b}$}}
  {=}
  {\Big\{\neg\phi({\mr x}\,;{\gr b})
  \ :\ 
  \phi({\mr x}\,;{\gr z})\in L(A)
  \textrm{ and } \phi(A^{\mr x};{\gr b})=\varnothing\Big\}.}\smallskip

  We write \emph{${\mr a}\equiv_A{\mr x}\cnonfork_A{\gr b}$} for the union of the types ${\mr x}\cnonfork_A{\gr b}$ and $\tp({\mr a}/A)$.
  By \ssf4 in Lemma~\ref{lem_coheir_independence} below, this is a consistent type over $A,{\gr b}$.
\end{definition}

The tuples ${\mr a}$ realizing ${\mr x}\cnonfork_A{\gr b}$ are exactly those such that ${\mr a}\cnonfork_A{\gr b}$.
Note that $\tp({\mr a}/A,{\gr b})$ is a coheir of $\tp({\mr a}/A)$ according to Definition~\ref{def_choeir_uno}, so the terminology is consistent.

We may think of ${\mr a}\cnonfork_A{\gr b}$ as saying that 
${\mr a}$ is \emph{independent\/} from ${\gr b}$ over $A$.
This is a strong notion of independence.
In general it is not symmetric, that is, ${\mr b}\cnonfork_A{\gr a}$ is not equivalent to ${\gr a}\cnonfork_A{\mr b}$. In Chapter~\ref{stability} we will see that symmetry is equivalent to stability.

\begin{remark}\label{rem_heir_type}
  In general there is no type that says ${\mr x}\cnonfork_A{\gr z}$, see Exercise~\ref{ex_heir_coheir_counterexample}.
  However, for every ${\gr b}\in\U^{\gr z}$ there is a type that says ${\mr x}\cnonfork_A{\gr z}\equiv_A{\gr b}$, namely\smallskip

  \ceq{\hfill p({\mr x}\,;{\mr z})}{\IFF}{ \big\{\neg\phi({\mr x}\,;{\gr z})\ :\ \phi(A^{\mr x}\,;{\gr b})=\varnothing, \ \ \phi({\mr x}\,;{\gr z})\in L(A)\big\}\ \cup\ q({\gr z})}\smallskip

  where $q({\gr z})=\tp({\gr b}/A)$.
\end{remark}

We will use the following easy lemma without explicit reference.

\begin{lemma}\label{lem_coheir_independence}
  The following properties hold for all $A,{\mr a},{\mr b}$, and $c$
  \begin{itemize}
  \item[1.] ${\mr a}\cnonfork_A{\gr b}\ \ \IMP\ \ f{\mr a}\cnonfork_Af{\gr b}$ \ \ 
            for every $f\in\Aut(\U/A)$\hfill \textit{invariance}
  \item[2.] ${\mr a}\cnonfork_A{\gr b}\ \ \IFF\ \ {\mr a_0}\cnonfork_A{\gr b_0}$
            \ for all finite ${\mr a_0}\subseteq{\mr a}$ and 
            ${\gr b_0}\subseteq{\gr b}$ \hfill\textit{finite character}
  \item[3.] ${\mr a}\cnonfork_{Ac},{\gr b}$ \ and \ 
            $c\cnonfork_A{\gr b}\ \ \IMP\ \ {\mr a},c\cnonfork_A{\gr b}$
            \hfill\hfill\hfill\textit{transitivity}
  \item[4.] ${\mr a}\cnonfork_A{\gr b}\ \ \IMP\ \ $ 
            there exists ${\mr a'}\equiv_{A,\,{\gr b}}{\mr a}$ such that 
            ${\mr a'}\cnonfork_A{\gr b},c$
            \hspace{\stretch{20}}\textit{coheir extension}
  \item[5.] ${\mr a}\cnonfork_A{\gr b_1},{\gr b_2}$ \ and \ 
  ${\gr b_1}\equiv_A{\gr b_2}\ \ \IMP\ \ {\gr b_1}\equiv_{A,\,{\mr a}}{\gr b_2}$
            \hspace{\stretch{20}}\textit{non-splitting}
  \end{itemize}
\end{lemma}
\begin{proof}
  Properties \ssf{1}-\ssf{3} follow immediately from Definition~\ref{def_coheir_idepencence}.
  We prove \ssf{4}.
  Assume ${\mr a}\cnonfork_A{\gr b}$, that is, $\tp({\mr a}/A,{\gr b})$ is finitely satisfiable in $A$.
  By Proposition~\ref{prop_exisntence_coheirs} $\tp({\mr a}/A,{\gr b})$ extends to a global type $p({\mr x})$ that is finitely satisfiable in $A$.
  Then any ${\mr a'}\models p_{\restriction A,\,{\gr b},\,c}({\mr x})$ proves the lemma.
  The proof of \ssf{5} is left to the reader.
\end{proof}

\begin{proposition}\label{prop_saturate_heir}
  Let ${\mr a}\cnonfork_A{\gr b}$ then there is $\V\preceq\U$ that is isomorphic to $\U$ over $A,{\gr b}$ and such that ${\mr a}\cnonfork_A\V$.
\end{proposition}

\begin{proof}
  Let $c$ be an enumeration of $\U$.
  Let $p(w,{\gr z})=\tp(c,{\gr b}/A)$.
  We can take $\V$ to be the structure enumerated by the tuple that realizes symultaneously $p(w,{\gr b}) $ and the following type 

  \ceq{\hfill\Big\{\neg\phi({\mr a},w)}{:}{\phi({\mr x},w)\in L(A),\ \ \phi(A^{\mr x},c)=\varnothing\Big\}.}

  We only need to prove finite consistency.
  If inconsistent, for some $\theta(w,{\gr z})\in p$ and some $\phi_i({\mr x},w)$ in the above set

  \ceq{\hfill\theta(w,{\gr b})}{\imp}{\bigvee_{i=1}^n\phi_i({\mr a},w).}
  
  As ${\mr a}\cnonfork_A{\gr b}$, we can replace ${\mr a}$ by some ${\mr a'}\in A^{\mr x}$.
  Finally, substituting $c$ for $w$, we obtain that $\phi_i({\mr a},c)$ holds for some $i$, a contradiction
\end{proof}

\begin{proposition}\label{prop_saturate_coheir}
  Let ${\mr a}\cnonfork_A{\gr b}$ then there is $\V\preceq\U$ that is isomorphic to $\U$ over $A,{\mr a}$ and such that $\V\cnonfork_A{\gr b}$.
  Moreover, we can require that $\V$ realizes every type $p(y)\subseteq L(A,{\gr b})$, for any $A\subseteq\V$, that is finitely satisfied in $\V$.
\end{proposition}

\begin{proof}
  Let $c$ be an enumeration of $\U$.
  Let $p(w,{\mr x})=\tp(c,{\mr a}/A)$.
  We can take $\V$ to be the structure enumerated by the tuple that realizes symultaneously $p(w,{\mr a}) $ and the type $w\cnonfork_A{\gr b}$, that is,

  \ceq{\hfill\Big\{\neg\phi(w,{\gr b})}{:}{\phi(w,{\gr z})\in L(A),\ \ \phi(A^w,{\gr b})=\varnothing\Big\}.}

  We only need to prove finite consistency.
  If inconsistent, for some $\theta(w,{\mr x})\in p$ and some $\phi_i(w,{\gr b})$ in the above set

  \ceq{\hfill\theta(w,{\mr a})}{\imp}{\bigvee_{i=1}^n\phi_i(w, {\gr b}).}
  
  As ${\mr a}\cnonfork_A{\gr b}$, we can replace ${\mr a}$ by some ${\mr a'}\in A^{\mr x}$.
  We can also require that $\E w\,\theta(w,{\mr a'})$.
  Then, by elementarity, $\theta(c',{\mr a'})$ holds for some $c'\in A^w$.
  Therefore, $\phi_i(c',{\gr b})$ holds for some $i$, a contradiction.
\end{proof}

\begin{proposition}\label{prop_b_saturate_coheir}
  Let $C\cnonfork_A{\gr b}$.
  There is $\W\cnonfork_A{\gr b}$ such that $C\subseteq\W\preceq\U$, and $\W$ realizes every type $p(x)\subseteq L(B,{\gr b})$, for any $B\subseteq\W$, that is finitely satisfied in $\W$.
\end{proposition}

\begin{proof}
  Construct inductively a chain of sets $C_i\cnonfork_A{\gr b}$, for $i<\kappa$.
  The chain starts with $C_0=C\cup A$, and is the union at limit stages.
  At successor stages we define $C_{i+1}=C_i\cup\{c_i\}$ for some suitable $c_i\cnonfork_{C_i}{\gr b}$.
  By \ssf3 in Lemma~\ref{lem_coheir_independence}, this ensures $C_{i+1}\cnonfork_A{\gr b}$.
  We choose the sequence $\<c_i:i<\kappa\>$ so that for every $n$ every complete type $p(x)\in S(C_n,{\gr b})$ that is finitely satisfiable in $C_n$ is eventually realized by some $c_i$.
  This ensure that $\W$, the union of the chain, realizes all the required types.
  To check that $\W\preceq\U$ note that, by Proposition~\ref{prop_saturate_coheir}, every consistent formula in $L(\W)$ has a solution in some $\V\cnonfork_A{\gr b}$.
\end{proof}

\begin{definition}\label{def_coheir_stationary} We say that $\cnonfork_M$ is \emph{stationary\/} if ${\mr a}\equiv_M{\mr x}\cnonfork_M{\gr b}$ is a complete type over $A,{\gr b}$ for all finite tuples ${\gr b}$ and ${\mr a}$.
We say \emph{$n$-stationary\/} if we limit the request to tuples ${\mr a}$ of length $n$.
\end{definition}

An application of stationarity is given in Section~\ref{semigroups}.
Stationarity is often ensured by the following property, which will receive due attention in Section~\ref{stable_theories}.

\begin{proposition}\label{prop_stationarity}
Let ${\mr x}$ be a tuple of variables of length $n$.
If for every $\phi({\mr x})\in L(\U)$ there is a formula $\psi({\mr x})\in L(M)$ such that $\phi(M^{\mr x})=\psi(M^{\mr x})$ then $\cnonfork_M$ is $n$-stationary.
\end{proposition}

\begin{proof}
Let ${\gr b}\in\U^{\gr z}$ and ${\mr a_1},{\mr a_2}\in\U^{\mr x}$ be such that ${\mr a_i}\cnonfork_M{\gr b}$ and ${\mr a_1}\equiv_M{\mr a_2}$.
We claim that ${\mr a_1}\equiv_{M,\,{\gr b}}{\mr a_2}$.
We need to prove that $\phi({\mr a_1}\,;{\gr b})\iff\phi({\mr a_2}\,;{\gr b})$ for every  $\phi({\mr x}\,;{\gr z})\in L(M)$.
Let $\psi({\mr x})\in L(M)$ be such that $\phi(M^{\mr x};{\gr b})=\psi(M^{\mr x})$.
From ${\mr a_i}\cnonfork_M{\gr b}$ we obtain that  $\phi({\mr a_i}\,;{\gr b})\iff\psi({\mr a_i})$.
Finally, the claim follows because ${\mr a_1}\equiv_M{\mr a_2}$.
\end{proof}

% \begin{lemma}\label{lem_coheirext}
% If ${\gr a}\nonforkc_A{\mr c}$ then for every ${\gr b}$ there is ${\mr c'}$ such that ${\gr a},\,{\gr b}\nonforkc_A{\mr c'}\equiv_{A,\,{\gr a}}{\mr c}$.
% \end{lemma}

% \begin{exercise}.
% Prove that every invariant type $q({\mr x})\subseteq L(\U)$ can be extended to a global invariant type $p({\mr x})\in S(\U)$.(?)
% \end{exercise}

% We say that $p({\mr x})\in S(\U)$ is a \emph{global heir\/} of $p_{\restriction M}({\mr x})$ if  
% 
% \ceq{\hfill{\gr\D_{p,\phi}}\cap M^{\gr z}\neq\varnothing}{\IFF}{{\gr\D_{p,\phi}}\neq\varnothing}  for every formula $\phi({\mr x}\,;{\gr z})\in L$.

%Every type over a model has an extension to a global coheir.
%A satisfactory generalization of this notions to types over sets should guarantee this existence.
%Unfortunately, this is not possible in general and the definition Section~\hyperref[coheirs_sets]{\ref*{invariantL}.\ref*{coheirs_sets}} is as good as it gets.

\begin{remark}\label{rk_coheir_stationary}
%The stationarity of $\cnonfork_A$ over every set $A$, or just over every model, is equivalent to the stability of $T$, see Section~\hyperref[stable_teories]{\ref*{external}.\ref*{stable_teories}}.
There are theories where the stationarity of $\cnonfork_M$ holds for some particular $M$.
For example, if every subset of $M^n$ is $M$-definable then $\cnonfork_M$ is $n$-stationary by Proposition~\ref{prop_stationarity}.
This simple observation will help in the proof of Theorem~\ref{thm_Hindman}.
For a natural example, let $T=T_{\rm dlo}$ and let $M\subseteq\U$ have the order type of $\RR$.
By quantifier elimination every definable subset of $\U$ is a union of finitely many intervals.
By Dedekind completeness, the trace on $M$ of any interval of $\U$ coincides with that of an $M$-definable interval.
Therefore $\cnonfork_M$ is $1$-stationary.
\end{remark}

\begin{exercise}
  Let $T$ be strongly minimal.
  Let $a\in\U^x$ and $b\in\U^z$, where $x$ and $z$ are finite tuples.
  Prove that the following are equivalent
  \begin{itemize}
    \item[1.] $a\cnonfork_M b$
    \item[2.] $\dim(b/M)=\dim(b/M,a)$
    \item[3.] $b\cnonfork_M a$.
  \end{itemize}
\end{exercise}

\begin{exercise}
  Let $a\cnonfork_M b$ then there is $\V\preceq\U$ that is isomorphic to $\U$ over $M,a$ and such that $\V\cnonfork_Mb$.
  Prove that we can also require that every type over $\V,b$ with $<\kappa$ parameters that is finitely satisfiable in $\V$ is realized in $\V$.
\end{exercise}

\begin{exercise}
  Let $a\cnonfork_M b$. 
  Prove that for every $c$ there is $b'\equiv_{M,a} b$ such that $a,c\cnonfork_M b'$. 
\end{exercise}

\begin{exercise}
  Let $N\succeq M$ be saturated and of cardinality $>|M|$.
  Let $a_i\cnonfork_M N, b$, for $i=1,2$. 
  Prove that if $a_1\equiv_N a_2$ then $a_1\equiv_{N,b} a_2$.
\end{exercise}

\begin{exercise}\label{ex_heir_coheir_counterexample}
  Show that in general there is no type $p(x\,;z)\subseteq L(M)$ such that 

   \ceq{\hfill a\cnonfork_M b}{\IFF}{a\,;b\models p(x\,;z).}

  Hint: consider the theory of dense linear orders without endpoints.
\end{exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Morley sequences and indiscernibles}

In what follows $\alpha$ is some ordinal $\le\kappa$, typically $\omega$, and ${\mr x}$ is a tuple of variables of length $<\kappa$.
Let \mbox{$p({\mr x})\in S(\U)$} be a global type.
We say that ${\mr\bar c}=\<{\mr c_i}:i<\alpha\>$ is a \emph{Morley sequence\/} of $p({\mr x})$ over $A$ if for every $i<\alpha$

\ceq{\ssf{Ms.}\hfill {\mr c_i}}{\models}{p_{\restriction  A,\,{\mr c_{\restriction i}}}({\mr x})}.

When $p({\mr x})$ is finitely satisfiable in $A$, we say that ${\mr\bar c}$ is a \emph{coheir sequence\/} of $p({\mr x})$ over $A$.
When we say that ${\mr\bar c}$ is a coheir sequence over $A$ (with no explicit reference to a global type), we mean that \textit{there is\/} a type $p({\mr x})\in S(\U)$ that is finitely satisfiable in $A$ such that ${\mr\bar c}$ is a coheir sequence of $p({\mr x})$.

The following is a convenient characterization of coheir sequences.

\begin{lemma}\label{lem_coheir_property}
The following are equivalent
\begin{itemize}
\item[1.] ${\mr\bar c}=\<{\mr c_n}:n<\omega\>$ is a coheir sequence over $M$
\item[2.] ${\mr c_n}\cnonfork_M{\mr c_{\restriction n}}$ and ${\mr c_{n+1}}\equiv_{M,\,{\mr c_{\restriction n}}}{\mr c_n}$ for every $n<\omega$.
\end{itemize}
\end{lemma}

\begin{proof}
\ssf{1}$\IMP$\ssf{2}.
Assume \ssf{1} and let $p({\mr x})\in S(\U)$ be a global type that is finitely satisfiable in $M$ and such that ${\mr c_i}\models p_{\restriction M,{\mr c_{\restriction i}}}({\mr x})$.
The requirement ${\mr c_{n+1}}\equiv_{M,{\mr c_{\restriction n}}} {\mr c_n}$ is clear.
Now, suppose $\phi({\mr c_{n+1}})$ for some $\phi({\mr x})\in L(M,{\mr c_{\restriction n+1}})$.
Then $\phi({\mr x})$ belongs to $p({\mr x})$, so $\phi(\U^{\mr x})\cap M^{\mr x}\neq\varnothing$ because $p({\mr x})$ is finitely satisfiable in $M$.
This proves ${\mr c_n}\cnonfork_M{\mr c_{\restriction n}}$.

\ssf{2}$\IMP$\ssf{1}.
Let $q({\mr x})=\{\phi({\mr x})\in L(M, {\mr\bar c})\,:\, \phi({\mr c_n}) \textrm{ holds for cofinitely many } n\}$.
%
We claim that $q({\mr x})$ is finitely satisfiable in $M$.
%
Let $\phi({\mr x}\,;{\mr z})\in L(M)$ be such that $\phi({\mr x}\,;{\mr c_{\restriction n}})\in q$.
%
By the definition of $q({\mr x})$, the formula $\phi({\mr c_m}\,;{\mr c_{\restriction n}})$ holds for all sufficiently large $m$.
%
Hence, from \ssf{2} we infer ${\mr c_m}\cnonfork_M{\mr c_{\restriction n}}$ and conclude that $\phi({\mr x}\,;{\mr c_{\restriction n}})$ is satisfied in $M$.

Let $p({\mr x})$ be any global extension of $q({\mr x})$ finitely saisfied in $M$.
%
We prove that ${\mr\bar c}$ is a Morley sequence of $p({\mr x})$ over $M$.
%
By \ssf{2} either ${\mr c_m}\models p_{\restriction  M,\,{\mr c_{\restriction n}}}({\mr x})$ for all $m\ge n$ or ${\mr c_m}\notmodels p_{\restriction  M,\,{\mr c_{\restriction n}}}({\mr x})$ for all $m\ge n$.
%
As $p({\mr x})$ extends $q({\mr x})$, the latter cannot occur.
\end{proof}

Let $(I,<_I)$ be a linear order.
A function ${\mr\bar a}:I\to\U^{\mr x}$ is said to be an \emph{$I$-sequence,} or simply a sequence when $I$ is clear.
We will often introduce an $I$-sequence as ${\mr\bar a}=\<{\mr a_i}: i\in I\>$.

If $I_0\subseteq I$ we call ${\mr a_{\restriction I_0}}$ a \emph{subsequence\/} of ${\mr\bar a}$.
The subsets $I_0\subseteq I$ that are well-ordered by $<_I$, in particular the finite ones, are especially relevant.
When $I_0$ has order type $\alpha$, an ordinal, we identify ${\mr a_{\restriction I_0}}$ with a tuple of length $\alpha$.

Recall that \emph{$I^{(n)}$} denotes that the set of \emph{$n$-subsets\/} of $I$,  i.e.\@ the subsets of $I$ of cardinality $n$.
The notation \smallskip

\ceq{\hfill\emph{$\displaystyle\binom{I}{n}$}}{=}{I^{(n)}}

is also common.
\begin{definition}
Let $(I,<_I)$ be an infinite linear order and let ${\mr\bar a}$ be an $I$-sequence.
We say that ${\mr\bar a}$ is a \emph{sequence of indiscernibles\/} over $A$ or, an \emph{$A$-indiscernible sequence\/}, if ${\mr a_{\restriction I_0}}\equiv_A {\mr a_{\restriction I_1}}$ for every $I_0,I_1\in I^{(n)}$ and $n<\omega$.

\end{definition}

The indiscernibility condition can be formulated in a number of equivalent ways.
For example, we can require that, for every formula $\phi(x_1,\dots,x_n)\in L(A)$ and every pair of tuples in $I^n$ such that $i_0<\dots<i_n$ and $j_0<\dots<j_n$,


\ceq{\hfill\phi(a_{i_0},\dots,a_{i_n})}{\iff}{\phi(a_{j_0},\dots,a_{j_n})}

Alternatively, we can simply say that for all $i_0,\dots,i_n\in I$ the type $\tp(a_{i_0},\dots,a_{i_n}/A)$ only depends on the order type of $i_0,\dots,i_n$.

\begin{proposition}
Let $p({\mr x})\in S(\U)$ be a global $A$-invariant type and let ${\mr\bar c}=\<{\mr c_i}:i<\alpha\>$ be a Morley sequence of $p({\mr x})$ over $A$.
Then ${\mr\bar c}$ is an $A$-indiscernibles sequence.
\end{proposition}

\begin{proof}

%\def\ceq#1#2#3{\parbox[t]{20ex}{$\displaystyle #1$}{\hspace*{1ex}$\displaystyle #2$\hspace*{1ex}}{$\displaystyle #3$}}

We prove by induction on $n<\omega$ that

\ceq{\sharp\hfill {\mr c_{\restriction n}}}{\ \equiv_A}{\mr c_{\restriction I_0}}\ \ \ for every $I_0\subseteq\alpha$ of cardinality $n$.

For $n=0$ the claim is trivial.
We assume inductively that $\,\sharp\,$ above is true and prove that

\ceq{\hfill {\mr c_{\restriction n}},{\mr c_n}}{\equiv_A}{{\mr c_{\restriction I_0}},{\mr c_i}}\ \ \ for every $I_0<i<\alpha$.

As ${\mr\bar c}$ is  Morley sequence, ${\mr c_n}\equiv_{A,{\mr c_{\restriction n}}} {\mr c_i}$ whenever $n<i$.
Hence we can equivalently prove that

\ceq{\hfill {\mr c_{\restriction n}},{\mr c_i}}{\equiv_A}{{\mr c_{\restriction I_0}},{\mr c_i},}

which is equivalent to

\ceq{\hfill {\mr c_{\restriction n}}}{\equiv_{A,\,{\mr c_i}}}{{\mr c_{\restriction I_0}}.}

The latter holds by induction hypothesis $\,\sharp\,$ and the invariance of $p({\mr x})$ as formulated in \ssf{it3} of Section~\ref{invariant_sets}.
\end{proof}

%Let $I,<_I$ and $J,<_J$ be two infinite linear orders and let $a$ and $b$ be an $I$-sequence, respectively a $J$-sequence
%Note that the expression $a\equiv_A b$ is meaningless unless there is a unique isomorphism between $I,<_I$ and $J,<_J$.However it always make sense, even for non isomorphic orders, when $a$ and $b$ are indiscernibles over $A$.In fact, we agree that \emph{$a\equiv_A b$\/} means $a_{\restriction I_0}\equiv_A b_{\restriction J_0}$ for every finite $I_0\subseteq I$ and $J_0\subseteq J$ of equal cardinality.% That being said, the following proposition is immediate.


% \begin{proposition}\label{prop_embedding_indsc_seq}
% Let $J,<_J$ be an infinite linear orders of cardinality $<\kappa$ and let $a$ be an $A$-in\-dis\-cern\-i\-ble $J$-sequence.

% Let $I,<_I$ be another infinite linear order, and $b$ and  $A$-in\-dis\-cern\-i\-ble $I$-sequence such that $a\equiv_Ab$.Let $f:J\to I$ be an embedding of linear orders.Then $h(a_i)=b_{f(i)}$ for some $h\in\Aut(\U/A)$.
% \end{proposition}


% 
% \begin{exercise}
% Let $c=\<{\mr c_i}:i<\alpha \>$ be a constant sequence, i.e.\@ ${\mr c_0}={\mr c_i}$ for all $i$. Prove that $c$ is a Morley sequence over $A$ if and only if ${\mr c_0}\in(\dcl A)^{\mr x}$ and that $c$ is a coheir sequence over $A$ if and only if  ${\mr c_0}\in A^{\mr x}$.
% \end{exercise}

% \begin{exercise}
% The following are equivalent
% \begin{itemize}
%  \item[1.] $\grD$ is invariant over $M$;
%  \item[2.] $c_0\in\grD\iff c_1\in\grD$ for every $M$-indiscernible sequence $\<c_i:i<\omega\>$ 
% \end{itemize}
% 
% \end{exercise}

% \begin{exercise}
%   Let $\bar a$ be a sequence such that $a_{\restriction I_0}\equiv a_{\restriction I_1}$ for every $I_0,I_1$ such that $I_0<I_1$.
%   Prove that $\bar a$ is a sequence of indiscernibles.
% \end{exercise}
