% !TEX root = creche.tex
\documentclass[creche.tex]{subfiles}
\begin{document}
\chapter{Stable formulas (a scribbling block)}
\label{stability}
 
\def\medrel#1{\parbox[t]{6ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox{25ex}{$\displaystyle #1$}\medrel{#2}$\displaystyle  #3$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Externally definable sets}
\label{external}


Let ${\gr\C},{\gr\D}\subseteq\U^{|{\gr z}|}$. The set ${\gr\D}\cap A^{|{\gr z}|}$ is called the \emph{trace\/} of ${\gr\D}$ over $A$. We write ${\gr\C}=_A{\gr\D}$ if  ${\gr\C}$ and ${\gr\D}$ have the same trace on $A$.

We say that ${\gr\D}$ is \emph{externally definable\/} if there are a global type $p\in S_{\mr x}(\U)$ and a formula $\phi({\mr x}\,;{\gr z})$ such that ${\gr\D}=\{{\gr a}\,:\,\phi({\mr x}\,;{\gr a})\in p\}$. Equivalently, a set ${\gr\D}$ is externally definable if it is the trace over $\U$ of a set which is definable in some elementary extension of $\U$. This explains the terminology.

\noindent\llap{\textcolor{red}{\Large\danger}\kern1.5ex}We prefer to deal with external definability in a different, though equivalent, way. This is not the most commond approach.

\begin{definition}\label{def_epprox}
We say that ${\gr\D}$ is \emph{approximable\/} by the formula $\phi({\mr x}\,;{\gr z})$ if for every finite $B$ there is a ${\mr b}\in\U^{|{\mr x}|}$ such that $\phi({\mr b}\,;{\gr\U})=_B{\gr\D}$. We may call the formula $\phi({\mr x}\,;{\gr z})$ the \emph{sort} of ${\gr\D}$. If in addition we have that $\phi({\mr b}\,;{\gr\U})\subseteq{\gr\D}$, we say that  ${\gr\D}$ is \emph{approximable from below}. If  ${\gr\D}\subseteq\phi({\mr b}\,;{\gr\U})$ we say that  ${\gr\D}$ is \emph{approximable from above}.\QED
\end{definition} 

Approximability from below is an adaptation to our context of the notion of \textit{having an honest definition} in \cite{CS}.  The following proposition is clear by compactness.

\begin{proposition}\label{lem_approx=external}
For every ${\gr\D}$ the following are equivalent:
\begin{itemize}
\item[1.] ${\gr\D}$ is approximable;
\item[2.] ${\gr\D}$ is externally definable.\QED 
\end{itemize}
\end{proposition}

\begin{example}
Let $T$ be the theory a dense linear orders without endpoints. Let $\D\subseteq\U$ be an interval. Then $\D$ is approximable both from below and from above by the formula \mbox{$x_1<z<x_2$}.  Now let $T$ be the theory of the random graph. Then every $\D\subseteq\U$ is approximable and, when $\D$ has small cardinality, it is approximable from above but not from below.\QED
\end{example}

In Definition~\ref{def_epprox}, the sort $\phi({\mr x}\,;{\gr z})$ is fixed (otherwise any set would be approximable) but this requirement of uniformity may be dropped if the sets $B$ are allowed to be infinite.

\begin{proposition}\label{lem_approx_nonunif}
For every ${\gr\D}$ the following are equivalent:
\begin{itemize}
\item[1.] ${\gr\D}$ is approximable;
\item[2.] for every $B\subseteq\U$ of cardinality $\le|T|$ there is $\psi({\gr z})\in L(\U)$ such that $\psi({\gr\U})=_B{\gr\D}$.
\end{itemize}
Similarly, the following are equivalent:
\begin{itemize}
\item[3.] ${\gr\D}$ is approximable from below;
\item[4.]  for every ${\gr B}\subseteq{\gr\D}$ of cardinality $\le|T|$ there is $\psi({\gr z})\in L(\U)$ such that ${\gr B}\subseteq \psi({\gr\U})\subseteq{\gr\D}$.
\end{itemize}
\end{proposition}

\begin{proof}
To prove \ssf{2}$\IMP$\ssf{1} assume \ssf{2} and negate \ssf{1} for a contradiction. For each formula $\psi({\mr x}\,;{\gr z})\in L$ choose a finite set $B$ such that $\psi({\mr b}\,;{\gr\U})\neq_B{\gr\D}$ for every ${\mr b}\in\U^{|{\mr x}|}$. Let $C$ be the union of all these finite sets. Clearly $|C|\le|T|$.  By \ssf{2} there are a formula $\phi({\mr x}\,;{\gr z})$ and a tuple ${\mr c}$ such that $\phi({\mr c}\,;{\gr\U})=_C{\gr\D}$, contradicting the definition of $C$.

The implication \ssf{1}$\IMP$\ssf{2} is obtained by compactness and the equivalence \ssf{3}$\IFF$\ssf{4} is proved similarly. 
\end{proof}

For ${\gr\C}\subseteq\U^{|{\gr z}|}$ the definition of  ${\gr\C}\equiv{\gr\D}$ is Section~\hyperref[expansions]{\ref{invariant}.\ref{expansions}}.

\begin{proposition}\label{prop_approx_el_eq}
If ${\gr\D}$ is approximable of sort $\phi({\mr x}\,;{\gr z})$ then so is any ${\gr\C}$ such that ${\gr\C}\equiv{\gr\D}$. The same holds for approximability from below and from above.
\end{proposition}

\begin{proof}
If the set ${\gr\D}$ is approximable by $\phi({\mr x}\,;{\gr z})$ then for every $n$

\hfil$\displaystyle\A {\gr z_1},\dots,{\gr z_n}\;\E {\mr x}\ \bigwedge^n_{i=1}\big[\phi({\mr x}\,;{\gr z_i})\ \iff\ {\gr z_i}\in{\gr \D}\big]$. 

So the same holds for any ${\gr\C}\equiv{\gr\D}$. As for approximability from below, add the conjunct $\A {\gr z}\,\big[\phi({\mr x}\,;{\gr z})\imp {\gr z}\in{\gr\D}\big]$ to the formula above, and similarly for approximability from above.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The ladder property}

The \emph{ladder order\/} of a parted formula $\phi({\mr x}\,;{\gr z})$ is the largest ordinal $n$ such that for some ${\mr a_i}\in\U^{|{\mr x}|}$ and ${\gr b_i}\in\U^{|{\gr z}|}$ 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{}

We say that $\D\subseteq\U^{|{\gr z}|}$ is \emph{approximable\/} by $\phi({\mr x}\,;{\gr z})$ if for every finite $B\subseteq\U^{|{\gr z}|}$ there is a ${\mr a}\in\U^{|{\mr x}|}$ such that $\phi({\mr a}\,;B)=\D\cap B$. For $A\subseteq\U$, we say approximable \emph{over $A$\/} if we can further require that ${\mr a}\in A^{|{\mr x}|}$. We say \emph{almost over $A$\/} if  ${\mr a}\in M^{|{\mr x}|}$ for every model $M$ containing $A$.

\begin{proposition}
If\/ $\D$ is\/ approximable from $A$, then it is invariant over $A$. If it is\/ ap\-prox\-i\-ma\-ble almost over $A$, then it is Lascar invariant over $A$.
\end{proposition}

\begin{proof}
Suppose for a contradiction that $f[\D]\neq\D$ for some $f\in\Aut(\U/A)$. Pick some ${\gr b}$ such that ${\gr b}\in\D\niff f{\gr b}\in\D$. Clearly $\big\{{\gr b},f{\gr b}\big\}\cap\D$ cannot be the trace on $\big\{{\gr b},f{\gr b}\big\}$ of a set definable over $A$. The same argument apply to prove Lascar invariance.
\end{proof}

Tentativo

Let $D\subseteq A$ be the trace on $A$ of a definable set, then it is the trace of some set $\Aa$ definable over $\acl^\eq A$, and such a set $\Aa$ is unique.

We write $\phi({\gr z}\,;{\mr x})^*$ for the parted formula with is the same as $\phi({\mr x}\,;{\gr z})$, as plain formula, but has a different partition of variables, ${\gr z}$ is the first tuple, ${\mr x}$ is the second tuple.

{
\def\B{{\gr{\EuScript B}}}
\def\Aa{{\mr{\EuScript A}}}
The following is a version of Harrinton's mysterious 
Lemma (cfr.~\cite[Lemma 8.3.4]{TZ}).
\begin{lemma}\label{lem_harrington}
Let $\phi({\mr x}\,;{\gr z})\in L$ be a stable formula and suppose $\B\subseteq\U^{|{\gr z}|}$ and $\Aa\subseteq\U^{|{\mr x}|}$ are approximated by $\phi({\mr x}\,;{\gr z})$ and  $\phi({\gr z}\,;{\mr x})^*$, respectively. Then the following are equivalent
\begin{itemize}
\item[1.] $\phi({\mr x}\,;{\gr z})\wedge{\mr x}\in{\Aa}$ approximates $\B$
\item[2.] $\phi({\gr z}\,;{\mr x})^*\wedge{\gr z}\in{\B}$ approximates $\Aa$ 
\end{itemize}
\end{lemma}
\begin{proof}
It suffices to prove \ssf{1}$\IMP$\ssf{2} because the converse implication is equivalent. Assume \ssf{1} and negate \ssf{2} for a contradiction.  As $\Aa$ is approximable, if not \ssf{2}, then  $\phi({\mr x}\,;{\gr z})\wedge{\gr z}\notin{\B}$ approximates $\Aa$. Pick ${\mr a_0}$ arbitrarily, then recursively find ${\gr b_i}\notin\B$ and  ${\mr a_i}\in\Aa$ such that


{\def\medrel#1{\parbox[t]{12ex}{$\displaystyle\kern2ex #1$}}

\ceq{\hfill\phi(\U\,;{\gr b_i})}{ =_{{\mr a_0},\dots,{\mr a_{i-1}}}}{\Aa} 


\ceq{\hfill\phi({\mr a_i}\,;\U)}{ =_{{\gr b_0},\dots,{\gr b_i}}}{\B}
}

Then

{\def\medrel#1{\parbox[t]{6ex}{$\displaystyle\kern2ex #1$}}

\ceq{\hfill i< j}{\IMP}{\phantom{\neg}\phi({\mr a_i}\,;{\gr b_j})}

\ceq{\hfill j\le i}{\IMP}{\neg\phi({\mr a_i}\,;{\gr b_j})}

}

Which contradicts the stability of $\phi({\mr x}\,;{\gr z})$.
\end{proof}

\begin{corollary}
Under the same assumptions of Lemma~\ref{lem_harrington} the following are mutually exclusive\nobreak
\begin{itemize}
\item[1.] $\phi({\mr x}\,;{\gr z})\wedge{\gr z}\notin{\B}$ approximates $\Aa$;
\item[2.] $\phi({\mr x}\,;{\gr z})\wedge{\gr z}\in{\B}$ approximates $\Aa$.\QED
\end{itemize}
\end{corollary}

}

\begin{proposition}
Let $A\subseteq\U$ and $\D\subseteq\U^{|{\gr z}|}$. Suppose that some stable formula $\phi({\mr x}\,;{\gr z})\in L$ approximates $\D\subseteq\U^{|{\gr z}|}$. Then the following are equivalent:
\begin{itemize}
\item[1.] $\D$ is invariant over $\acl^\eq A$;
\item[2.] $\D$ is definable over $\acl^\eq A$.
\end{itemize}
\end{proposition}

\begin{proof}
Only \ssf{1}$\IMP$\ssf{2} requires a proof. Assume \ssf{1}. By stability, $\D$ is definable. By invariance, $\D\in M^\eq$ for every model $M$ containing $A$ and \ssf{2} follows.
\end{proof}


\begin{proposition}
For every $M$ and every externally definable set $\D$ is some $\B\equiv_M\D$ that is approximable in $M$. 
\end{proposition}

\begin{proof}

\end{proof}


\section{Notes e references}
\begin{biblist}[]\normalsize



\bib{CS}{article}{
   author={Chernikov, Artem},
   author={Simon, Pierre},
   title={Externally definable sets and dependent pairs},
   journal={Israel J. Math.},
   volume={194},
   date={2013},
   number={1},
   pages={409--425},
   %issn={0021-2172},
   %doi={10.1007/s11856-012-0061-9},
}

\bib{TZ}{book}{
   author={Tent, Katrin},
   author={Ziegler, Martin},
   title={A course in model theory},
   series={Lecture Notes in Logic},
   volume={40},
   publisher={Association for Symbolic Logic, Cambridge
   University Press},
   date={2012},
   pages={x+248},
   %isbn={978-0-521-76324-0},
   %doi={10.1017/CBO9781139015417},
}



\end{biblist}


\end{document}


